/**
 * 阶段4：选举提示词配置
 * 从多次生成结果中选出最优的一个
 */

/**
 * 选举系统提示词
 */
export const ELECTION_SYSTEM_PROMPT = `你是春联质量评选专家。从多次生成的春联中选出最优的一个作为最终结果。

## 评选原则
1. **字数优先**：优先选择字数符合要求的春联
2. **单数优先**：传统对联忌讳双数，优先选择字数为单数（5/7/9字）的对联
3. **平仄优先**：在字数符合的基础上，优先选择平仄合规的
4. **对仗优先**：在平仄符合的基础上，优先选择对仗工整的
5. **内容优先**：在对仗符合的基础上，优先选择寓意吉祥、语言通顺的

## 评选标准
- 必须满足字数要求（上下联字数相等且为指定字数）
- 优先选择单数字数（5/7/9字），避免双数（4/6/8字）
- 末字平仄符合要求（上联末字仄声，下联末字平声）
- 对仗基本工整（词性大致相对，结构大致相应）
- 内容可读（寓意吉祥，无错别字，语言通顺）

## 重要说明
⚠️ **对联传统**：传统对联忌讳使用双数字数（4/6/8字），认为单数（5/7/9字）更符合传统审美。在选举时，如果多个候选都符合基本要求，优先选择单数字数的对联。

## 输出要求
- 返回JSON格式
- 包含selectedIndex（选中的索引，从0开始）、reason（选择理由）
- 选择理由要具体说明为什么选中这个结果，包括字数是否为单数`;

/**
 * 构建选举用户提示词
 * @param candidates 候选春联列表
 * @param wordCount 要求的字数
 * @returns 选举用户提示词
 */
export function buildElectionPrompt(
  candidates: Array<{
    upperCouplet: string;
    lowerCouplet: string;
    horizontalScroll: string;
    springScrolls: string[];
  }>,
  wordCount: string
): string {
  return `从以下${candidates.length}个候选春联中选出最优的一个作为最终结果。

## 候选春联列表
${candidates.map((c, i) => `
### 候选${i + 1}
- 上联：${c.upperCouplet}
- 下联：${c.lowerCouplet}
- 横批：${c.horizontalScroll}
- 挥春：${c.springScrolls.join('、')}
- 字数检查：上联${c.upperCouplet.length}字，下联${c.lowerCouplet.length}字
`).join('\n')}

## 评选要求
1. **字数严格**：必须选择上下联字数均为${wordCount}字的候选
2. **单数优先**：传统对联忌讳双数，优先选择字数为单数（5/7/9字）的候选。如果多个候选都符合基本要求，优先选择单数字数的对联
3. **平仄优先**：在字数符合的候选中，优先选择末字平仄正确的
4. **对仗优先**：在平仄符合的候选中，优先选择对仗更工整的
5. **内容优先**：在对仗符合的候选中，优先选择寓意更好、语言更通顺的

## 重要提醒
⚠️ **对联传统**：传统对联忌讳使用双数字数（4/6/8字），认为单数（5/7/9字）更符合传统审美。在选举时，如果多个候选都符合基本要求，**必须优先选择单数字数的对联**。

## 输出格式
{
  "selectedIndex": 选中的候选索引（从0开始）,
  "reason": "选择理由，说明为什么选中这个结果，包括字数是否为单数"
}`;
}
